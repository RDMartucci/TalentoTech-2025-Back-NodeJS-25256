<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Taller de tu api al navegador</title>
</head>
<body>
  <h1>Lista de Items</h1>
  
  <form id="form-crear">
    <input type="text" id="nombre" placeholder="Nuevo item" required />
    <input type="text" id="categoria" placeholder="Nuevo item cat" required />
    <button type="submit">Enviar</button>
  </form>

  <ul id="lista-items"></ul>

  <script>
    const lista = document.getElementById("lista-items");
    const form = document.getElementById("form-crear");
    const inputNombre = document.getElementById("nombre");
    const inputCategoria = document.getElementById("categoria")

    // Obtener y mostrar los items
    async function obtenerItems() {
      try {
        const res = await fetch("http://localhost:3000/items");
        const data = await res.json();
        console.log("Front->ObtenerItems->items: ",data)
        lista.innerHTML = "";
        data.forEach(item => {
          const li = document.createElement("li");
          li.textContent = item.nombre;
          //agregando categoria
          li.textContent += " - " + item.categoria;
          //agregando id
          li.textContent += " (ID: " + item.id + ")";
          
          lista.appendChild(li);
        });
      } catch (error) {
        console.error("Error al obtener items:", error);
      }
    }

    obtenerItems(); // Cargar al inicio

    // Enviar nuevo item (POST)
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const nuevoItem = { nombre: inputNombre.value, categoria: inputCategoria.value };

      try {
        const res = await fetch("http://localhost:3000/items", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(nuevoItem)
        });

        if (res.ok) {
          inputNombre.value = "";
          obtenerItems(); // refresca lista
        } else {
          console.error("Error en el POST");
        }
      } catch (error) {
        console.error("Error al enviar item:", error);
      }
    });
  </script>
</body>
</html>
